<html>

<head>
  <meta charset="UTF-8">
  <title>WeKan — Hall of Fame / ReactionBleed</title>
  <link rel="icon" href="../../wekan-favicon.png">
  <link rel="stylesheet" type="text/css" href="../../main.css">
  <link href='https://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css">
</head>

<body>

  <img vAlign="center" src="../hof.svg" alt="Hall of Fame image from https://openclipart.org/detail/120343/trophy"
    width="300px" height="auto" />
  <br />

  <div class="action-buttons">
    <a class="button" href="https://wekan.github.io/hall-of-fame">Back to Hall of Fame Contents</a>
    <a class="button" href="https://wekan.github.io">Back to Wekan Website</a>
  </div>

  <div class="hof">
    <h1 class="hof">Contents / ReactionBleed</h1>

    <table border="1" margin="0" padding="10px" width="100%">

      <tr>
        <th width="10%">CVE</th>
        <th width="10%">Vulnerability name</th>
        <th width="10%">Date</th>
        <th width="20%">
          <a href="https://github.com/wekan/wekan/blob/master/SECURITY.md">Responsible Security Disclosure</a>
          by
        </th>
        <th width="40%">Vulnerabilities</th>
      </tr>

      <tr>
       <td valign="top">
          TODO
        </td>
        <td valign="top"><b>ReactionBleed</b> <h2><i class="fa fa-thumbs-o-up" aria-hidden="true"></i> <i class="fa fa-tint" style="color: red;" aria-hidden="true"></i></h2></td>
        <td valign="top">2023-02-28 12.36 EET</td>
        <td valign="top">
          <b><a href="https://jetinfosystems.com">Alexander Starikov at Jet Infosystems</a></b><br />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" /><br />
          Did send detailed report and fix!</a>
        </td>
        <td valign="top">
          <ul>
            <li>Security: XSS in feature "Reaction to comment"</li>
            <li>Affected Wekan v5.49 - v6.84</li>
            <li>Fixed at <a href="https://github.com/wekan/wekan/blob/master/CHANGELOG.md#v685-2023-04-18-wekan--release">Wekan v6.85 2023-04-18</a></li>
          </ul>
        </td>
      </tr>

    </table>
  </div>

  <br />
  <br />

  <div class="hof">
    <table border="1" margin="0" padding="10px" width="100%">

      <tr>
        <th width="5%">Timeline</th>
        <th width="60%">Details</th>
      </tr>
      <tr>
        <td vAlign="top"><a name="FIELD"></a><b>2023-02-28 12.36 EET</b></td>
        <td vAlign="top">
          Report received.<br />
          <br />
<pre>
Hello,
 
I found XSS vulnerability in “reaction on comment” functionality. An attacker with user privilege on board can insert JavaScript code instead of reaction.
 
Name: Alexander Starikov at Jet Infosystems (https://jetinfosystems.com/)
Twitter: @alexstar_46
Bug type: Stored XSS
Severity: Medium
CVSS (optional): AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N (5.4)
CWSS (optional): CWE-79: Improper Neutralization of Input During WebPage Generation ('Cross-site Scripting')

Tested on:
- Self-hosted Wekan, latest version - v6.76 (last commit:8a0899a819cef5a2c779edbe16a3edddb7450d84)
- Firefox verison 110.0

Steps to reproduce (screenshots in the attachment):
1) Add a comment in card:
2) Add any reaction on comment and intercept this request in Proxy (I use Burp Suite).
Replace the default “reactionCodepoint” value on payload: &lt;img src=1 onerror=alert()&gt;:

Impact: An attacker can execute JavaScript code in the browsers of users who open card with “malicious reaction”. For example, attacker can steal Meteor.loginToken or change page content for phishing.

If you have any questions I will be happy to answer them.
</pre>

        </td>
      </tr>

      <tr>
        <td vAlign="top"></a><b>2023-04-03 17.36 EET</b></td>
        <td vAlign="top">WeKan Support had some trouble reproducing bug and creating fix,
           so WeKan Support asked could Alexander try to fix it and send patch?
        </td>
      </tr>
      <tr>
        <td vAlign="top"></a><b>2023-04-10 14.47 EET</b></td>
        <td vAlign="top">Alexander sent patch that has fix.
        </td>
      </tr>
      <tr>
        <td vAlign="top"></a><b>2023-04-18</b></td>
        <td valign="top">
          <ul>
            <li>Security: XSS in feature "Reaction to comment"</li>
            <li>Affected Wekan v5.49 - v6.84</li>
            <li>Fixed at <a href="https://github.com/wekan/wekan/blob/master/CHANGELOG.md#v685-2023-04-18-wekan--release">Wekan v6.85 2023-04-18</a></li>
          </ul>
        </td>
      </tr>

    </table>
  </div>

  <br />
  <br />

  <div class="action-buttons">
    <a class="button" href="https://wekan.github.io/hall-of-fame">Back to Hall of Fame Contents</a>
    <a class="button" href="https://wekan.github.io">Back to Wekan Website</a>
  </div>

  <h1>
    <br />
  </h1>

</body>

</html>
