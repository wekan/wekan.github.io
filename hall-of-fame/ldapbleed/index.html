<html>

<head>
  <meta charset="UTF-8">
  <title>Wekan â€” Hall of Fame / LDAPbleed</title>
  <link rel="icon" href="../../wekan-favicon.png">
  <link rel="stylesheet" type="text/css" href="../../main.css">
  <link href='https://fonts.googleapis.com/css?family=Droid+Sans' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../../font-awesome/css/font-awesome.min.css">
</head>

<body>

  <img vAlign="center" src="../hof.svg" alt="Hall of Fame image from https://openclipart.org/detail/120343/trophy"
    width="300px" height="auto" />
  <br />

  <div class="action-buttons">
    <a class="button" href="https://wekan.github.io/hall-of-fame">Back to Hall of Fame Contents</a>
    <a class="button" href="https://wekan.github.io">Back to Wekan Website</a>
  </div>

  <div class="hof">
    <h1 class="hof">Contents / LDAPbleed</h1>

    <table border="1" margin="0" padding="10px" width="100%">

      <tr>
        <th width="10%">CVE</th>
        <th width="10%">Vulnerability name</th>
        <th width="10%">Date</th>
        <th width="20%">
          <a href="https://github.com/wekan/wekan/blob/main/SECURITY.md">Responsible Security Disclosure</a>
          by
        </th>
        <th width="40%">Vulnerabilities</th>
      </tr>

      <tr>
        <td valign="top">
          <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3309">CVE-2021-3309</a>
        </td>
        <td valign="top"><b>LDAPbleed</b> <h2><i class="fa fa-sitemap" aria-hidden="true"></i> <i class="fa fa-tint" style="color: red;" aria-hidden="true"></i></h2></td>
        <td valign="top">2021-01-26 0:42 EET</td>
        <td valign="top">
          <b><a href="https://github.com/robert-scheck">robert-scheck</a></b><br />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" />
          <img src="../GoldStar.png" width="30px" height="auto" /><br />
          Did send report and sent fix! Although, report was at <a href="https://github.com/wekan/wekan/issues/3482">public GitHub issue</a>, not via <a href="https://github.com/wekan/wekan/blob/main/SECURITY.md" style="color: red;">Responsible Security Disclosure</a>
        </td>
        <td valign="top">
          <ul>
            <li>Security: SSL/TLS certificate validation for LDAP disabled by default</li>
            <li>Affected Wekan v1.53.1-v4.87</li>
            <li>Fixed at <a href="https://github.com/wekan/wekan/blob/main/CHANGELOG.md#v488-2021-01-28-wekan-release">Wekan v4.88 2021-01-28</a></li>
          </ul>
        </td>
      </tr>

    </table>
  </div>

  <br />
  <br />

  <div class="hof">
    <table border="1" margin="0" padding="10px" width="100%">

      <tr>
        <th width="5%">Timeline</th>
        <th width="60%">Details</th>
      </tr>
      <tr>
        <td vAlign="top"><a name="FIELD"></a><b>2021-01-26 0:42 EET</b></td>
        <td vAlign="top">
          Report received at <a href="https://github.com/wekan/wekan/issues/3482">public GitHub issue</a>.<br />
          <br />
          robert-scheck wrote:<br /><br />

          As of writing, Wekan disables the SSL/TLS certificate validation for LDAP by default <a href="https://github.com/wekan/wekan/blob/main/packages/wekan-ldap/server/ldap.js#L22">
          unless <code>LDAP_REJECT_UNAUTHORIZED=true</code></a> is explicitly set.
          Thus, by default, Wekan is effectively vulnerable to MITM attacks, even when using SSL/TLS for LDAP.
          I treat this default behaviour as bad, given that security shouldn't be opt-in but opt-out (e.g. for test-only environments).
          As this behaviour does not seem to be properly documented for system administrators (at least not outside of the source code),
          I would treat this as a vulnerability following <a href="https://cwe.mitre.org/data/definitions/295.html">CWE-295: Improper Certificate Validation</a> and thus as a CVE-worthy candidate.

          Oh, and please note that Node.js itself has, according to its <a href="https://nodejs.org/docs/latest/api/tls.html">documentation</a>,
          a security-wise default by having true as default for <code>rejectUnauthorized</code>.<br />
        </td>
      </tr>

      <tr>
        <td vAlign="top">
          <b>2021-01-28</b>
        </td>
        <td vAlign="top">
          <a href="https://github.com/wekan/wekan/blob/main/CHANGELOG.md#v488-2021-01-28-wekan-release">Wekan v4.88 2021-01-28</a>
            released by xet7 with <a href="https://github.com/wekan/wekan/pull/3483">fix from robert-scheck</a>.
        </td>
      </tr>

    </table>
  </div>

  <br />
  <br />

  <div class="action-buttons">
    <a class="button" href="https://wekan.github.io/hall-of-fame">Back to Hall of Fame Contents</a>
    <a class="button" href="https://wekan.github.io">Back to Wekan Website</a>
  </div>

  <h1>
    <br />
  </h1>

</body>

</html>
